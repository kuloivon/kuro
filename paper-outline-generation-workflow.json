{
  "name": "è®ºæ–‡å¤§çº²ç”Ÿæˆå·¥ä½œæµ",
  "nodes": [
    {
      "parameters": {
        "httpMethod": "POST",
        "path": "/outline-generation",
        "options": {}
      },
      "id": "o1p2q3r4-s5t6-7890-abcd-ef1234567890",
      "name": "å¤§çº²ç”Ÿæˆè§¦å‘å™¨",
      "type": "n8n-nodes-base.webhook",
      "typeVersion": 1,
      "position": [100, 100],
      "webhookId": "outline-generation"
    },
    {
      "parameters": {
        "values": [
          {
            "name": "llmApiUrl",
            "value": "https://api.openai.com/v1/chat/completions"
          },
          {
            "name": "llmModel",
            "value": "gpt-4"
          },
          {
            "name": "embeddingApiUrl",
            "value": "https://api.openai.com/v1/embeddings"
          },
          {
            "name": "knowledgeBaseUrl",
            "value": "http://localhost:3000/api/knowledge-search"
          },
          {
            "name": "writingWorkflowUrl",
            "value": "http://localhost:5678/webhook/writing-agent"
          }
        ]
      },
      "id": "p2q3r4s5-t6u7-8901-bcde-f23456789012",
      "name": "ç¯å¢ƒé…ç½®",
      "type": "n8n-nodes-base.set",
      "typeVersion": 2,
      "position": [100, 300]
    },
    {
      "parameters": {
        "functionCode": "// è§£æè¾“å…¥æ•°æ®å¹¶æå–å…³é”®ä¿¡æ¯ç”¨äºçŸ¥è¯†åº“æ£€ç´¢\nfor (const item of $input.all()) {\n  const documentAnalysis = item.json.documentAnalysis;\n  \n  // æ„å»ºæœç´¢æŸ¥è¯¢\n  const searchQueries = [];\n  \n  // ä¸»é¢˜ç›¸å…³æŸ¥è¯¢\n  if (documentAnalysis.theme) {\n    searchQueries.push({\n      type: 'theme',\n      query: documentAnalysis.theme,\n      priority: 'high'\n    });\n  }\n  \n  // å…³é”®æ¦‚å¿µæŸ¥è¯¢\n  documentAnalysis.concepts.forEach(concept => {\n    searchQueries.push({\n      type: 'concept',\n      query: concept + ' è®ºæ–‡ç»“æ„',\n      priority: 'medium'\n    });\n  });\n  \n  // å­¦ç§‘é¢†åŸŸæŸ¥è¯¢\n  const disciplineKeywords = [\n    'è®ºæ–‡å†™ä½œæ–¹æ³•', 'å­¦æœ¯å†™ä½œè§„èŒƒ', 'è®ºæ–‡å¤§çº²æ¨¡æ¿',\n    documentAnalysis.theme + ' ç ”ç©¶æ–¹æ³•'\n  ];\n  \n  disciplineKeywords.forEach(keyword => {\n    searchQueries.push({\n      type: 'methodology',\n      query: keyword,\n      priority: 'medium'\n    });\n  });\n  \n  // æ·»åŠ é€šç”¨è®ºæ–‡ç»“æ„æŸ¥è¯¢\n  searchQueries.push({\n    type: 'structure',\n    query: 'å­¦æœ¯è®ºæ–‡æ ‡å‡†ç»“æ„ ç« èŠ‚å®‰æ’',\n    priority: 'high'\n  });\n  \n  item.json.searchQueries = searchQueries;\n  item.json.originalAnalysis = documentAnalysis;\n  \n}\n\nreturn $input.all();"
      },
      "id": "q3r4s5t6-u7v8-9012-cdef-345678901234",
      "name": "æ„å»ºçŸ¥è¯†åº“æœç´¢æŸ¥è¯¢",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [300, 100]
    },
    {
      "parameters": {
        "url": "{{ $('ç¯å¢ƒé…ç½®').item.json.knowledgeBaseUrl }}",
        "method": "POST",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Content-Type",
              "value": "application/json"
            }
          ]
        },
        "sendBody": true,
        "bodyParameters": {
          "parameters": [
            {
              "name": "queries",
              "value": "={{ $json.searchQueries }}"
            },
            {
              "name": "limit",
              "value": "10"
            },
            {
              "name": "includeScore",
              "value": "true"
            }
          ]
        },
        "options": {
          "timeout": 30000
        }
      },
      "id": "r4s5t6u7-v8w9-0123-def0-456789012345",
      "name": "çŸ¥è¯†åº“æ£€ç´¢",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4,
      "position": [500, 100]
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "={{ $json.results && $json.results.length > 0 }}",
            "operation": "equal",
            "rightValue": "true"
          }
        }
      },
      "id": "s5t6u7v8-w9x0-1234-ef01-567890123456",
      "name": "æ£€æŸ¥çŸ¥è¯†åº“ç»“æœ",
      "type": "n8n-nodes-base.if",
      "typeVersion": 1,
      "position": [700, 100]
    },
    {
      "parameters": {
        "url": "{{ $('ç¯å¢ƒé…ç½®').item.json.llmApiUrl }}",
        "authentication": "predefinedCredentialType",
        "nodeCredentialType": "httpHeaderAuth",
        "method": "POST",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Content-Type",
              "value": "application/json"
            }
          ]
        },
        "sendBody": true,
        "bodyParameters": {
          "parameters": [
            {
              "name": "model",
              "value": "{{ $('ç¯å¢ƒé…ç½®').item.json.llmModel }}"
            },
            {
              "name": "messages",
              "value": "=[{\"role\": \"system\", \"content\": \"ä½ æ˜¯ä¸€ä¸ªä¸“ä¸šçš„å­¦æœ¯è®ºæ–‡å†™ä½œæŒ‡å¯¼ä¸“å®¶ã€‚åŸºäºæä¾›çš„æ–‡æ¡£åˆ†æå’ŒçŸ¥è¯†åº“ä¿¡æ¯ï¼Œè®¾è®¡ä¸€ä¸ªå®Œæ•´ã€ä¸“ä¸šçš„è®ºæ–‡å¤§çº²ã€‚\\n\\nè®¾è®¡åŸåˆ™ï¼š\\n1. éµå¾ªå­¦æœ¯å†™ä½œè§„èŒƒå’Œæ ‡å‡†ç»“æ„\\n2. ç¡®ä¿é€»è¾‘æ¸…æ™°ã€å±‚æ¬¡åˆ†æ˜\\n3. æ¯ä¸ªç« èŠ‚éƒ½æœ‰æ˜ç¡®çš„ç›®æ ‡å’Œå†…å®¹è¦æ±‚\\n4. è€ƒè™‘è®ºè¯çš„å®Œæ•´æ€§å’Œè¯´æœåŠ›\\n5. é€‚åº”å…·ä½“å­¦ç§‘é¢†åŸŸçš„ç‰¹ç‚¹\\n\\nè¾“å‡ºæ ¼å¼ä¸ºJSONï¼š\\n{\\n  \\\"outlineStructure\\\": {\\n    \\\"title\\\": \\\"è®ºæ–‡æ ‡é¢˜\\\",\\n    \\\"abstract\\\": \\\"æ‘˜è¦å†…å®¹è¦æ±‚\\\",\\n    \\\"keywords\\\": [\\\"å…³é”®è¯1\\\", \\\"å…³é”®è¯2\\\"],\\n    \\\"chapters\\\": [\\n      {\\n        \\\"chapterNumber\\\": 1,\\n        \\\"title\\\": \\\"ç« èŠ‚æ ‡é¢˜\\\",\\n        \\\"objective\\\": \\\"æœ¬ç« ç›®æ ‡\\\",\\n        \\\"mainPoints\\\": [\\\"è¦ç‚¹1\\\", \\\"è¦ç‚¹2\\\"],\\n        \\\"sections\\\": [\\n          {\\n            \\\"sectionNumber\\\": \\\"1.1\\\",\\n            \\\"title\\\": \\\"å°èŠ‚æ ‡é¢˜\\\",\\n            \\\"content\\\": \\\"å…·ä½“å†…å®¹è¦æ±‚\\\",\\n            \\\"wordCount\\\": ä¼°è®¡å­—æ•°\\n          }\\n        ],\\n        \\\"expectedWordCount\\\": é¢„æœŸå­—æ•°\\n      }\\n    ],\\n    \\\"references\\\": \\\"å‚è€ƒæ–‡çŒ®è¦æ±‚\\\",\\n    \\\"totalWordCount\\\": æ€»é¢„æœŸå­—æ•°\\n  },\\n  \\\"writingGuidelines\\\": {\\n    \\\"style\\\": \\\"å†™ä½œé£æ ¼è¦æ±‚\\\",\\n    \\\"tone\\\": \\\"è¯­è°ƒè¦æ±‚\\\",\\n    \\\"academicLevel\\\": \\\"å­¦æœ¯æ°´å¹³\\\",\\n    \\\"citationStyle\\\": \\\"å¼•ç”¨æ ¼å¼\\\"\\n  },\\n  \\\"qualityRequirements\\\": [\\\"è´¨é‡è¦æ±‚1\\\", \\\"è´¨é‡è¦æ±‚2\\\"]\\n}\"}, {\"role\": \"user\", \"content\": \"è¯·åŸºäºä»¥ä¸‹ä¿¡æ¯è®¾è®¡è®ºæ–‡å¤§çº²ï¼š\\n\\n## æ–‡æ¡£åˆ†æç»“æœ\\n**ä¸»é¢˜ï¼š** {{ $('æ„å»ºçŸ¥è¯†åº“æœç´¢æŸ¥è¯¢').item.json.originalAnalysis.theme }}\\n**æ‘˜è¦ï¼š** {{ $('æ„å»ºçŸ¥è¯†åº“æœç´¢æŸ¥è¯¢').item.json.originalAnalysis.summary }}\\n\\n**å…³é”®è¦ç‚¹ï¼š**\\n{{ $('æ„å»ºçŸ¥è¯†åº“æœç´¢æŸ¥è¯¢').item.json.originalAnalysis.keyPoints.map((point, index) => `${index + 1}. ${point}`).join('\\n') }}\\n\\n**æ ¸å¿ƒæ¦‚å¿µï¼š** {{ $('æ„å»ºçŸ¥è¯†åº“æœç´¢æŸ¥è¯¢').item.json.originalAnalysis.concepts.join(', ') }}\\n\\n## çŸ¥è¯†åº“æ£€ç´¢ç»“æœ\\n{{ $json.results ? $json.results.slice(0, 5).map((result, index) => `${index + 1}. ${result.title || result.content.substring(0, 100)}... (ç›¸å…³åº¦: ${result.score})`).join('\\n') : 'æ— ç›¸å…³çŸ¥è¯†åº“ä¿¡æ¯' }}\\n\\nè¯·è®¾è®¡ä¸€ä¸ªå®Œæ•´çš„è®ºæ–‡å¤§çº²ã€‚\"}]"
            },
            {
              "name": "temperature",
              "value": "0.3"
            },
            {
              "name": "max_tokens",
              "value": "3000"
            }
          ]
        }
      },
      "id": "t6u7v8w9-x0y1-2345-f012-678901234567",
      "name": "LLMå¤§çº²ç”Ÿæˆï¼ˆæœ‰çŸ¥è¯†åº“ï¼‰",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4,
      "position": [900, 80]
    },
    {
      "parameters": {
        "url": "{{ $('ç¯å¢ƒé…ç½®').item.json.llmApiUrl }}",
        "authentication": "predefinedCredentialType",
        "nodeCredentialType": "httpHeaderAuth",
        "method": "POST",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Content-Type",
              "value": "application/json"
            }
          ]
        },
        "sendBody": true,
        "bodyParameters": {
          "parameters": [
            {
              "name": "model",
              "value": "{{ $('ç¯å¢ƒé…ç½®').item.json.llmModel }}"
            },
            {
              "name": "messages",
              "value": "=[{\"role\": \"system\", \"content\": \"ä½ æ˜¯ä¸€ä¸ªä¸“ä¸šçš„å­¦æœ¯è®ºæ–‡å†™ä½œæŒ‡å¯¼ä¸“å®¶ã€‚åŸºäºæä¾›çš„æ–‡æ¡£åˆ†æï¼Œè®¾è®¡ä¸€ä¸ªå®Œæ•´ã€ä¸“ä¸šçš„è®ºæ–‡å¤§çº²ã€‚\\n\\nè®¾è®¡åŸåˆ™ï¼š\\n1. éµå¾ªå­¦æœ¯å†™ä½œè§„èŒƒå’Œæ ‡å‡†ç»“æ„\\n2. ç¡®ä¿é€»è¾‘æ¸…æ™°ã€å±‚æ¬¡åˆ†æ˜\\n3. æ¯ä¸ªç« èŠ‚éƒ½æœ‰æ˜ç¡®çš„ç›®æ ‡å’Œå†…å®¹è¦æ±‚\\n4. è€ƒè™‘è®ºè¯çš„å®Œæ•´æ€§å’Œè¯´æœåŠ›\\n5. é€‚åº”å…·ä½“å­¦ç§‘é¢†åŸŸçš„ç‰¹ç‚¹\\n\\næ ‡å‡†å­¦æœ¯è®ºæ–‡ç»“æ„å‚è€ƒï¼š\\n- æ‘˜è¦ (Abstract)\\n- å¼•è¨€/ç»ªè®º (Introduction)\\n- æ–‡çŒ®ç»¼è¿° (Literature Review)\\n- ç ”ç©¶æ–¹æ³• (Methodology)\\n- ç»“æœä¸åˆ†æ (Results and Analysis)\\n- è®¨è®º (Discussion)\\n- ç»“è®º (Conclusion)\\n- å‚è€ƒæ–‡çŒ® (References)\\n\\nè¾“å‡ºæ ¼å¼ä¸ºJSONï¼ˆä¸æœ‰çŸ¥è¯†åº“ç‰ˆæœ¬ç›¸åŒçš„æ ¼å¼ï¼‰ã€‚\"}, {\"role\": \"user\", \"content\": \"è¯·åŸºäºä»¥ä¸‹æ–‡æ¡£åˆ†æè®¾è®¡è®ºæ–‡å¤§çº²ï¼š\\n\\n**ä¸»é¢˜ï¼š** {{ $('æ„å»ºçŸ¥è¯†åº“æœç´¢æŸ¥è¯¢').item.json.originalAnalysis.theme }}\\n**æ‘˜è¦ï¼š** {{ $('æ„å»ºçŸ¥è¯†åº“æœç´¢æŸ¥è¯¢').item.json.originalAnalysis.summary }}\\n\\n**å…³é”®è¦ç‚¹ï¼š**\\n{{ $('æ„å»ºçŸ¥è¯†åº“æœç´¢æŸ¥è¯¢').item.json.originalAnalysis.keyPoints.map((point, index) => `${index + 1}. ${point}`).join('\\n') }}\\n\\n**æ ¸å¿ƒæ¦‚å¿µï¼š** {{ $('æ„å»ºçŸ¥è¯†åº“æœç´¢æŸ¥è¯¢').item.json.originalAnalysis.concepts.join(', ') }}\\n\\nè¯·è®¾è®¡ä¸€ä¸ªå®Œæ•´çš„è®ºæ–‡å¤§çº²ã€‚\"}]"
            },
            {
              "name": "temperature",
              "value": "0.3"
            },
            {
              "name": "max_tokens",
              "value": "3000"
            }
          ]
        }
      },
      "id": "u7v8w9x0-y1z2-3456-0123-789012345678",
      "name": "LLMå¤§çº²ç”Ÿæˆï¼ˆæ— çŸ¥è¯†åº“ï¼‰",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4,
      "position": [900, 200]
    },
    {
      "parameters": {},
      "id": "v8w9x0y1-z2a3-4567-1234-890123456789",
      "name": "å¤§çº²ç»“æœåˆå¹¶",
      "type": "n8n-nodes-base.merge",
      "typeVersion": 2,
      "position": [1100, 140]
    },
    {
      "parameters": {
        "functionCode": "// å¤„ç†å¤§çº²ç”Ÿæˆç»“æœå¹¶è¿›è¡Œè´¨é‡æ£€æŸ¥\nfor (const item of $input.all()) {\n  try {\n    const llmResponse = JSON.parse(item.json.choices[0].message.content);\n    const originalAnalysis = $('æ„å»ºçŸ¥è¯†åº“æœç´¢æŸ¥è¯¢').first().json.originalAnalysis;\n    \n    // è´¨é‡æ£€æŸ¥\n    const qualityChecks = {\n      hasTitle: !!llmResponse.outlineStructure.title,\n      hasAbstract: !!llmResponse.outlineStructure.abstract,\n      hasKeywords: llmResponse.outlineStructure.keywords && llmResponse.outlineStructure.keywords.length > 0,\n      hasChapters: llmResponse.outlineStructure.chapters && llmResponse.outlineStructure.chapters.length >= 3,\n      hasReferences: !!llmResponse.outlineStructure.references,\n      chaptersHaveObjectives: llmResponse.outlineStructure.chapters ? \n        llmResponse.outlineStructure.chapters.every(ch => ch.objective) : false,\n      sectionsHaveContent: llmResponse.outlineStructure.chapters ? \n        llmResponse.outlineStructure.chapters.every(ch => \n          ch.sections && ch.sections.every(sec => sec.content)\n        ) : false\n    };\n    \n    const qualityScore = Object.values(qualityChecks).filter(Boolean).length / Object.values(qualityChecks).length;\n    \n    // ç”Ÿæˆå†™ä½œä»»åŠ¡åˆ†è§£\n    const writingTasks = [];\n    \n    if (llmResponse.outlineStructure.chapters) {\n      llmResponse.outlineStructure.chapters.forEach((chapter, chapterIndex) => {\n        if (chapter.sections) {\n          chapter.sections.forEach((section, sectionIndex) => {\n            writingTasks.push({\n              taskId: `task-${chapterIndex + 1}-${sectionIndex + 1}`,\n              type: 'section_writing',\n              chapter: chapter.chapterNumber,\n              section: section.sectionNumber,\n              title: section.title,\n              requirements: {\n                content: section.content,\n                wordCount: section.wordCount || 500,\n                objective: chapter.objective,\n                context: chapter.mainPoints\n              },\n              dependencies: sectionIndex > 0 ? [`task-${chapterIndex + 1}-${sectionIndex}`] : [],\n              priority: chapter.chapterNumber <= 2 ? 'high' : 'medium',\n              status: 'pending'\n            });\n          });\n        }\n      });\n    }\n    \n    // æ„å»ºå®Œæ•´ç»“æœ\n    const outlineResult = {\n      // åŸºç¡€ä¿¡æ¯\n      generatedAt: new Date().toISOString(),\n      originalDocument: originalAnalysis.title,\n      sourceTheme: originalAnalysis.theme,\n      \n      // å¤§çº²ç»“æ„\n      outline: llmResponse.outlineStructure,\n      \n      // å†™ä½œæŒ‡å¯¼\n      guidelines: llmResponse.writingGuidelines,\n      qualityRequirements: llmResponse.qualityRequirements,\n      \n      // è´¨é‡è¯„ä¼°\n      qualityCheck: {\n        score: qualityScore,\n        details: qualityChecks,\n        status: qualityScore >= 0.8 ? 'excellent' : qualityScore >= 0.6 ? 'good' : 'needs_review'\n      },\n      \n      // å†™ä½œä»»åŠ¡åˆ†è§£\n      writingTasks: writingTasks,\n      \n      // å¤„ç†çŠ¶æ€\n      processingStage: 'outline_completed',\n      nextStage: 'writing_tasks_assignment'\n    };\n    \n    item.json = outlineResult;\n    \n  } catch (error) {\n    item.json = {\n      error: 'å¤§çº²ç”Ÿæˆç»“æœå¤„ç†å¤±è´¥',\n      errorMessage: error.message,\n      originalResponse: item.json,\n      processingStage: 'outline_generation_failed'\n    };\n  }\n}\n\nreturn $input.all();"
      },
      "id": "w9x0y1z2-a3b4-5678-2345-901234567890",
      "name": "å¤§çº²ç»“æœå¤„ç†",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [1300, 140]
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "={{ $json.qualityCheck && $json.qualityCheck.status === 'needs_review' }}",
            "operation": "equal",
            "rightValue": "true"
          }
        }
      },
      "id": "x0y1z2a3-b4c5-6789-3456-012345678901",
      "name": "è´¨é‡æ£€æŸ¥",
      "type": "n8n-nodes-base.if",
      "typeVersion": 1,
      "position": [1500, 140]
    },
    {
      "parameters": {
        "functionCode": "// ç”Ÿæˆæ˜“è¯»çš„å¤§çº²Markdownæ–‡ä»¶\nfor (const item of $input.all()) {\n  const data = item.json;\n  const outline = data.outline;\n  \n  let markdownContent = `# ${outline.title}\\n\\n`;\n  markdownContent += `**ç”Ÿæˆæ—¶é—´ï¼š** ${data.generatedAt}\\n`;\n  markdownContent += `**åŸå§‹æ–‡æ¡£ï¼š** ${data.originalDocument}\\n`;\n  markdownContent += `**è´¨é‡è¯„åˆ†ï¼š** ${(data.qualityCheck.score * 100).toFixed(1)}% (${data.qualityCheck.status})\\n\\n`;\n  \n  markdownContent += `## ğŸ“ æ‘˜è¦è¦æ±‚\\n\\n${outline.abstract}\\n\\n`;\n  \n  markdownContent += `## ğŸ·ï¸ å…³é”®è¯\\n\\n${outline.keywords.join(', ')}\\n\\n`;\n  \n  markdownContent += `## ğŸ“‹ è®ºæ–‡ç»“æ„\\n\\n`;\n  \n  // ç”Ÿæˆç« èŠ‚å¤§çº²\n  if (outline.chapters) {\n    outline.chapters.forEach(chapter => {\n      markdownContent += `### ç¬¬${chapter.chapterNumber}ç«  ${chapter.title}\\n\\n`;\n      markdownContent += `**æœ¬ç« ç›®æ ‡ï¼š** ${chapter.objective}\\n\\n`;\n      \n      if (chapter.mainPoints && chapter.mainPoints.length > 0) {\n        markdownContent += `**ä¸»è¦å†…å®¹ï¼š**\\n`;\n        chapter.mainPoints.forEach((point, index) => {\n          markdownContent += `${index + 1}. ${point}\\n`;\n        });\n        markdownContent += `\\n`;\n      }\n      \n      if (chapter.sections) {\n        markdownContent += `**ç« èŠ‚å®‰æ’ï¼š**\\n\\n`;\n        chapter.sections.forEach(section => {\n          markdownContent += `#### ${section.sectionNumber} ${section.title}\\n\\n`;\n          markdownContent += `${section.content}\\n\\n`;\n          markdownContent += `*é¢„æœŸå­—æ•°ï¼š${section.wordCount || 'å¾…å®š'}å­—*\\n\\n`;\n        });\n      }\n      \n      markdownContent += `**æœ¬ç« é¢„æœŸå­—æ•°ï¼š** ${chapter.expectedWordCount || 'å¾…è®¡ç®—'}å­—\\n\\n`;\n      markdownContent += `---\\n\\n`;\n    });\n  }\n  \n  markdownContent += `## ğŸ“š å‚è€ƒæ–‡çŒ®è¦æ±‚\\n\\n${outline.references}\\n\\n`;\n  \n  markdownContent += `## âœï¸ å†™ä½œæŒ‡å¯¼\\n\\n`;\n  if (data.guidelines) {\n    markdownContent += `**å†™ä½œé£æ ¼ï¼š** ${data.guidelines.style}\\n`;\n    markdownContent += `**è¯­è°ƒè¦æ±‚ï¼š** ${data.guidelines.tone}\\n`;\n    markdownContent += `**å­¦æœ¯æ°´å¹³ï¼š** ${data.guidelines.academicLevel}\\n`;\n    markdownContent += `**å¼•ç”¨æ ¼å¼ï¼š** ${data.guidelines.citationStyle}\\n\\n`;\n  }\n  \n  if (data.qualityRequirements && data.qualityRequirements.length > 0) {\n    markdownContent += `## ğŸ¯ è´¨é‡è¦æ±‚\\n\\n`;\n    data.qualityRequirements.forEach((req, index) => {\n      markdownContent += `${index + 1}. ${req}\\n`;\n    });\n    markdownContent += `\\n`;\n  }\n  \n  markdownContent += `## ğŸ“Š å†™ä½œç»Ÿè®¡\\n\\n`;\n  markdownContent += `- **æ€»é¢„æœŸå­—æ•°ï¼š** ${outline.totalWordCount || 'å¾…è®¡ç®—'}å­—\\n`;\n  markdownContent += `- **ç« èŠ‚æ•°é‡ï¼š** ${outline.chapters ? outline.chapters.length : 0}ç« \\n`;\n  markdownContent += `- **å†™ä½œä»»åŠ¡æ•°ï¼š** ${data.writingTasks.length}ä¸ª\\n`;\n  markdownContent += `- **è´¨é‡è¯„åˆ†ï¼š** ${(data.qualityCheck.score * 100).toFixed(1)}%\\n\\n`;\n  \n  markdownContent += `---\\n\\n`;\n  markdownContent += `*æœ¬å¤§çº²ç”±AIåŠ©æ‰‹è‡ªåŠ¨ç”Ÿæˆï¼Œå»ºè®®äººå·¥å®¡æ ¸ç¡®è®¤åå¼€å§‹å†™ä½œ*\\n`;\n  \n  // ç”Ÿæˆæ–‡ä»¶å\n  const timestamp = new Date().toISOString().slice(0, 19).replace(/[T:]/g, '-');\n  const fileName = `paper-outline-${timestamp}.md`;\n  \n  item.json.outlineMarkdown = markdownContent;\n  item.json.outlineFileName = fileName;\n  item.binary = {\n    data: Buffer.from(markdownContent).toString('base64'),\n    fileName: fileName,\n    mimeType: 'text/markdown'\n  };\n}\n\nreturn $input.all();"
      },
      "id": "y1z2a3b4-c5d6-7890-4567-123456789012",
      "name": "ç”Ÿæˆå¤§çº²Markdown",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [1700, 100]
    },
    {
      "parameters": {
        "url": "{{ $('ç¯å¢ƒé…ç½®').item.json.writingWorkflowUrl }}",
        "method": "POST",
        "sendBody": true,
        "bodyParameters": {
          "parameters": [
            {
              "name": "outlineData",
              "value": "={{ $json }}"
            }
          ]
        }
      },
      "id": "z2a3b4c5-d6e7-8901-5678-234567890123",
      "name": "è§¦å‘å†™ä½œä»»åŠ¡å·¥ä½œæµ",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4,
      "position": [1900, 100]
    },
    {
      "parameters": {
        "message": "âš ï¸ å¤§çº²è´¨é‡éœ€è¦äººå·¥å®¡æ ¸\\n\\n**è´¨é‡è¯„åˆ†ï¼š** {{ ($json.qualityCheck.score * 100).toFixed(1) }}%\\n**é—®é¢˜è¯¦æƒ…ï¼š** {{ Object.entries($json.qualityCheck.details).filter(([key, value]) => !value).map(([key]) => key).join(', ') }}\\n\\nè¯·å®¡æ ¸å¤§çº²å†…å®¹åæ‰‹åŠ¨è§¦å‘ä¸‹ä¸€æ­¥éª¤ã€‚",
        "additionalFields": {
          "title": "å¤§çº²éœ€è¦å®¡æ ¸"
        }
      },
      "id": "a3b4c5d6-e7f8-9012-6789-345678901234",
      "name": "äººå·¥å®¡æ ¸é€šçŸ¥",
      "type": "n8n-nodes-base.webhook",
      "typeVersion": 1,
      "position": [1500, 300]
    },
    {
      "parameters": {
        "message": "âœ… è®ºæ–‡å¤§çº²ç”Ÿæˆå®Œæˆ\\n\\n**è®ºæ–‡æ ‡é¢˜ï¼š** {{ $json.outline.title }}\\n**ç« èŠ‚æ•°é‡ï¼š** {{ $json.outline.chapters.length }}ç« \\n**å†™ä½œä»»åŠ¡ï¼š** {{ $json.writingTasks.length }}ä¸ª\\n**è´¨é‡è¯„åˆ†ï¼š** {{ ($json.qualityCheck.score * 100).toFixed(1) }}%\\n\\nä¸‹ä¸€æ­¥ï¼šå¼€å§‹åˆ†ä»»åŠ¡å†™ä½œ",
        "additionalFields": {
          "title": "å¤§çº²ç”ŸæˆæˆåŠŸ"
        }
      },
      "id": "b4c5d6e7-f8g9-0123-7890-456789012345",
      "name": "æˆåŠŸé€šçŸ¥",
      "type": "n8n-nodes-base.webhook",
      "typeVersion": 1,
      "position": [2100, 100]
    }
  ],
  "connections": {
    "å¤§çº²ç”Ÿæˆè§¦å‘å™¨": {
      "main": [
        [
          {
            "node": "æ„å»ºçŸ¥è¯†åº“æœç´¢æŸ¥è¯¢",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "æ„å»ºçŸ¥è¯†åº“æœç´¢æŸ¥è¯¢": {
      "main": [
        [
          {
            "node": "çŸ¥è¯†åº“æ£€ç´¢",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "çŸ¥è¯†åº“æ£€ç´¢": {
      "main": [
        [
          {
            "node": "æ£€æŸ¥çŸ¥è¯†åº“ç»“æœ",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "æ£€æŸ¥çŸ¥è¯†åº“ç»“æœ": {
      "main": [
        [
          {
            "node": "LLMå¤§çº²ç”Ÿæˆï¼ˆæœ‰çŸ¥è¯†åº“ï¼‰",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "LLMå¤§çº²ç”Ÿæˆï¼ˆæ— çŸ¥è¯†åº“ï¼‰",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "LLMå¤§çº²ç”Ÿæˆï¼ˆæœ‰çŸ¥è¯†åº“ï¼‰": {
      "main": [
        [
          {
            "node": "å¤§çº²ç»“æœåˆå¹¶",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "LLMå¤§çº²ç”Ÿæˆï¼ˆæ— çŸ¥è¯†åº“ï¼‰": {
      "main": [
        [
          {
            "node": "å¤§çº²ç»“æœåˆå¹¶",
            "type": "main",
            "index": 1
          }
        ]
      ]
    },
    "å¤§çº²ç»“æœåˆå¹¶": {
      "main": [
        [
          {
            "node": "å¤§çº²ç»“æœå¤„ç†",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "å¤§çº²ç»“æœå¤„ç†": {
      "main": [
        [
          {
            "node": "è´¨é‡æ£€æŸ¥",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "è´¨é‡æ£€æŸ¥": {
      "main": [
        [
          {
            "node": "ç”Ÿæˆå¤§çº²Markdown",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "äººå·¥å®¡æ ¸é€šçŸ¥",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ç”Ÿæˆå¤§çº²Markdown": {
      "main": [
        [
          {
            "node": "è§¦å‘å†™ä½œä»»åŠ¡å·¥ä½œæµ",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "è§¦å‘å†™ä½œä»»åŠ¡å·¥ä½œæµ": {
      "main": [
        [
          {
            "node": "æˆåŠŸé€šçŸ¥",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "active": false,
  "settings": {},
  "versionId": "outline-workflow-v1.0",
  "meta": {
    "description": "è®ºæ–‡å¤§çº²ç”Ÿæˆå·¥ä½œæµï¼šåŸºäºæ–‡æ¡£åˆ†æç»“æœï¼Œç»“åˆçŸ¥è¯†åº“æ£€ç´¢ï¼Œç”Ÿæˆç»“æ„åŒ–çš„è®ºæ–‡å¤§çº²ï¼ŒåŒ…å«å†™ä½œæŒ‡å¯¼å’Œä»»åŠ¡åˆ†è§£ã€‚æ”¯æŒè´¨é‡æ£€æŸ¥å’Œäººå·¥å®¡æ ¸æœºåˆ¶ã€‚",
    "category": "ai-integration",
    "tags": ["è®ºæ–‡å¤§çº²", "çŸ¥è¯†åº“æ£€ç´¢", "ç»“æ„è®¾è®¡", "å†™ä½œæŒ‡å¯¼", "ä»»åŠ¡åˆ†è§£"]
  }
}